# Phase 7: Docker Compose for Autodoc Extractor\n# Complete development and production setup\n\nversion: '3.8'\n\nservices:\n  # Main FastAPI backend\n  backend:\n    build: .\n    ports:\n      - \"8000:8000\"\n    volumes:\n      # Persistent storage for uploads and results\n      - ./tmp:/app/tmp\n      - ./data:/app/data\n      - ./models:/app/models\n    environment:\n      - PYTHONPATH=/app\n      - FASTAPI_ENV=production\n      - LOG_LEVEL=INFO\n    restart: unless-stopped\n    healthcheck:\n      test: [\"CMD\", \"curl\", \"-f\", \"http://localhost:8000/health\"]\n      interval: 30s\n      timeout: 10s\n      retries: 3\n      start_period: 40s\n\n  # Redis for job queue (optional, for production scaling)\n  redis:\n    image: redis:7-alpine\n    ports:\n      - \"6379:6379\"\n    volumes:\n      - redis_data:/data\n    restart: unless-stopped\n    profiles:\n      - production\n\n  # Nginx reverse proxy (optional)\n  nginx:\n    image: nginx:alpine\n    ports:\n      - \"80:80\"\n      - \"443:443\"\n    volumes:\n      - ./nginx.conf:/etc/nginx/nginx.conf:ro\n      - ./ssl:/etc/ssl:ro\n    depends_on:\n      - backend\n    restart: unless-stopped\n    profiles:\n      - production\n\n  # Monitoring with Prometheus (optional)\n  prometheus:\n    image: prom/prometheus:latest\n    ports:\n      - \"9090:9090\"\n    volumes:\n      - ./monitoring/prometheus.yml:/etc/prometheus/prometheus.yml:ro\n      - prometheus_data:/prometheus\n    restart: unless-stopped\n    profiles:\n      - monitoring\n\nvolumes:\n  redis_data:\n  prometheus_data:\n\nnetworks:\n  default:\n    name: autodoc-network\n\n# Usage:\n# Development: docker-compose up\n# Production: docker-compose --profile production up\n# With monitoring: docker-compose --profile production --profile monitoring up\n\n# Environment variables for production:\n# Create .env file with:\n# - DATABASE_URL (if using database)\n# - REDIS_URL (if using Redis)\n# - SECRET_KEY (for JWT tokens)\n# - CORS_ORIGINS (allowed frontend origins)\n# - MAX_UPLOAD_SIZE (file size limit)\n# - CLEANUP_INTERVAL_HOURS (auto cleanup)